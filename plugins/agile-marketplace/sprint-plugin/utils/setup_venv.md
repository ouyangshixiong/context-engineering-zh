# Python虚拟环境配置规范

## 环境管理原则

### 隔离性原则
每个项目必须使用独立的Python虚拟环境，确保依赖包的隔离性和版本一致性。

### 可重复性原则
通过requirements文件精确记录依赖版本，确保在不同环境中能够重现相同的运行结果。

### 自动化原则
环境配置过程应尽可能自动化，减少手动操作带来的错误。

## 配置流程

### 技术规范优先检查
在执行环境配置前，优先检查是否存在 `tech.md` 文件。如果存在，以 `tech.md` 中的技术规范作为环境配置的主要标准。

### 环境创建
使用Python内置的venv模块创建虚拟环境，避免使用第三方工具带来的兼容性问题。

### 环境激活
在运行任何Python代码或安装依赖包之前，必须激活对应的虚拟环境。

### 依赖安装
按照优先级顺序安装依赖包：
1. 优先使用 `tech.md` 中指定的依赖版本和配置
2. 其次使用 `requirements.txt` 或 `requirements_ml.txt` 文件中的指定版本
3. 确保依赖版本一致性

## 最佳实践

### 技术规范优先原则
- 优先读取 `tech.md` 中的技术选型和依赖配置
- 如果 `tech.md` 与 `requirements.txt` 存在冲突，以 `tech.md` 为准
- 记录技术规范与实际安装版本的对应关系

### 环境检查
在执行Python相关操作前，应检查当前是否处于正确的虚拟环境中。

### 依赖管理
定期更新requirements文件，记录所有生产环境必需的依赖包。

### 环境清理
项目完成后应及时清理虚拟环境，释放系统资源。

## 集成要求

### 工具集成
所有自动化工具和脚本在安装Python包前必须检查venv状态，确保在正确的环境中操作。

### 文档引用
在涉及环境配置的文档中，应引用本规范文件以确保一致性。

## 质量保证

### 验证机制
建立环境状态验证机制，确保开发、测试和生产环境的一致性。

### 错误处理
提供清晰的错误提示和解决方案，帮助用户快速解决环境配置问题。

## 配置优先级

### 环境配置优先级顺序
1. **tech.md 技术规范** (最高优先级)
   - Python版本要求
   - 框架版本要求 (PyTorch/PaddlePaddle等)
   - 特定依赖版本
   - 环境配置参数

2. **VENV_CONFIG.md 环境规范**
   - 环境矩阵配置
   - 一键安装流程
   - 版本兼容性矩阵

3. **requirements.txt/requirements_ml.txt**
   - 依赖包列表
   - 版本约束

4. **项目结构检测**
   - setup.py/pyproject.toml
   - Python源代码文件
   - venv目录

### Python项目识别
- 存在requirements.txt或requirements_ml.txt文件
- 存在setup.py或pyproject.toml文件
- 存在Python源代码文件(.py)
- 存在venv目录

### 非Python项目处理
当检测到项目不是Python项目时，应跳过venv环境安装和激活步骤。