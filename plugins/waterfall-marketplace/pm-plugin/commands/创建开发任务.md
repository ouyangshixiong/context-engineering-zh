---
description: 本文档用于将Jira系统中已创建的子需求，明确每个子需求（subtask）的业务目标、功能描述，分解并撰写需求对应技术实现计划，形成开发任务（tasks）,关联（relates to）对应的子需求。文档遵循Waterfall/V模型的需求分解规范，仅生成Markdown格式的需求文档，不包含代码或配置内容。
---

# 创建开发任务 Command
> 通过该流程，PM 能够在 Jira 系统中快速将子需求转化为开发任务。

## 核心原则

### 统一父级结构
- **父级统一为Story**: 所有子需求和开发任务都挂在对应Story下
- **便于统计**: 便于统计Story完成度和Sprint Burn-down

### 类型统一与语义区分
- **统一使用Subtask类型**: 所有子需求和开发任务都使用Subtask类型
- **标签区分语义**:
  - `label = "requirement"` → 子需求（Sub-requirement）
  - `label = "implementation"` → 开发任务（Task）
  - `label = "DEV-[SubtaskKey]-[序号]"` → 开发任务关联标识（用于自动链接）

### 可追溯性
- **链接关系**: 每个开发任务通过"Relates"链接关联到对应的子需求
- **逻辑链**: 在JQL或插件中形成完整的逻辑链：Story → 子需求 → 开发任务

## 前置条件检查

在执行本命令前，请确保：

1. **已执行发现命令**
   - 请先执行 `/pm-plugin:epic-stories-subtasks发现` 命令
   - 通过发现命令找到需要分解的目标Story
   - 获取Story的完整Key（如：STORY-123）

2. **JIRA配置就绪**
   - 确保用户目录中的jira.md配置文件存在且正确配置
   - 包含JIRA_DOMAIN、user-email、auth-token

## 编号规范

### 开发任务编号 (pm-plugin)
- **格式**: `DEV-[SubtaskKey]-[序号]`
- **示例**: `DEV-CMT-48-1`
- **用途**: 标识子需求（subtask）进一步分解出的开发任务
- **类型**: 使用Subtask类型，通过label="implementation"区分
- **显示**: 编号会显示在开发任务的Summary中，格式为`[DEV-CMT-48-1] 任务描述`

### 编号优势
- 清晰标识父子关系层级
- 便于搜索和过滤
- 支持需求追踪和状态管理


## 工作流程

1. **开发任务创建**
   - 调用 `create_development_tasks.py` 创建开发任务
   - 读取tech.md文件获取技术配置
   - 为每个子需求创建1-N个开发任务
   - 基于技术栈生成具体的开发任务

2. **子需求与子任务链接**
   - 调用`create_issue_links.py` 在jira中创建子需求和子任务的相互链接
   - 检测子任务，确保都链接到了相应子需求
   - 检查开发任务编号规范，确保相关字段符合规范

3. **子需求与子开发任务对齐检查**
   - 调用 `validate_subtask_alignment.py` 检查对齐质量
   - 验证子需求与子开发任务的内容一致性
   - 检查技术实现路径的完整性
   - 确保业务目标与开发任务的对齐

4. **分解质量验证**
   - 调用 `validate_decomposition_quality.py` 验证分解质量
   - 评估Subtask内容的完整性和可执行性
   - 生成质量评分和改进建议


## 集成脚本说明

### analyze_story_context.py
- 分析Story的完整上下文
- 显示Story基本信息、关联Epic、现有Subtask
- 分析业务价值和技术依赖


### enrich_subtasks_content.py
- 为空白Subtask填充具体内容
- 自动生成业务目标、功能边界、技术实现路径
- 设置清晰的验收标准

### validate_decomposition_quality.py
- 验证Story分解的质量
- 评估Subtask内容的完整性和可执行性
- 提供质量评分和改进建议

### create_development_tasks.py
- 创建开发任务
- 读取tech.md文件获取技术配置
- 为每个子需求创建1-N个开发任务
- 基于技术栈生成具体的开发任务
- **开发任务编号规范**: `DEV-[SubtaskKey]-[序号]`，例如 `DEV-CMT-48-1`
- **类型**: 使用Subtask类型，通过label="implementation"区分
- **链接**: 自动创建"Relates"链接到对应的子需求

### validate_subtask_alignment.py
- 检查子需求与子开发任务的对齐质量
- 验证内容一致性和技术实现完整性
- 确保业务目标与开发任务的对齐
- 生成对齐质量报告和改进建议

## 输出示例

```

📋 Story上下文分析:
   标题: 功能模块实现
   描述: 实现系统核心功能模块...
   关联Epic: EPIC-1
   现有Subtask: 3

💡 技术建议生成:
   发现技术关键词: 核心功能, 模块实现
   生成技术实现路径...

🎯 子任务自动创建:
   基于Story类型创建3个子任务:
   - 核心功能开发
   - 功能测试验证
   - 技术文档编写

🔧 开发任务创建:
   读取tech.md技术配置
   为3个子需求创建开发任务:
   - 前端界面开发 (2个任务) [Subtask类型 + implementation标签]
   - 后端API开发 (3个任务) [Subtask类型 + implementation标签]
   - 数据库设计 (1个任务) [Subtask类型 + implementation标签]

🔗 自动创建链接:
   为6个开发任务创建Relates链接到对应的子需求

🎨 Subtask内容充实:
   为3个子需求和6个子开发任务填充详细内容...

🔍 子需求与开发任务对齐检查:
   检查3个子需求与6个开发任务的对齐性:
   - 业务目标对齐: 100%
   - 技术实现完整性: 100%
   - 验收标准一致性: 100%
   - 链接关系完整性: 100%


```

## 规则

- 使用Atlassian Document格式处理JIRA描述字段
- 确保与现有requirements-plugin的配置兼容
- 提供清晰的错误处理和用户提示
- 支持中英文双语输出
- 仅生成Markdown格式的需求文档，不包含代码或配置内容