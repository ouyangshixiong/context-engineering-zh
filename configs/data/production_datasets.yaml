# ğŸš€ éƒ¨ç½²ç”¨å¤§æ•°æ®é›†é…ç½®
# ä¸“ä¸ºDOCKERéƒ¨ç½²é˜¶æ®µè®¾è®¡ï¼Œæ”¯æŒå®Œæ•´æ•°æ®é›†è®­ç»ƒ

defaults:
  - _self_

# ç”Ÿäº§æ•°æ®é›†åˆ—è¡¨
production_datasets:
  coco2017:
    name: "COCO2017-production"
    dataset_type: "COCODetection"
    description: "COCO2017å®Œæ•´æ•°æ®é›†ï¼Œ118Kè®­ç»ƒå›¾åƒï¼Œ80ä¸ªç›®æ ‡ç±»åˆ«"
    
    # å®Œæ•´æ•°æ®é…ç½®
    data_dir: "./data/production/coco2017"
    train_dir: "train2017"
    val_dir: "val2017"
    test_dir: "test2017"
    annotations_dir: "annotations"
    
    # å®Œæ•´æ•°æ®è§„æ¨¡
    num_samples: 118287
    train_samples: 118287
    val_samples: 5000
    test_samples: 40670
    
    # 80ä¸ªCOCOç±»åˆ«å®Œæ•´åˆ—è¡¨
    num_classes: 80
    class_names: [
      "person", "bicycle", "car", "motorcycle", "airplane", "bus", "train", "truck",
      "boat", "traffic light", "fire hydrant", "stop sign", "parking meter", "bench",
      "bird", "cat", "dog", "horse", "sheep", "cow", "elephant", "bear", "zebra",
      "giraffe", "backpack", "umbrella", "handbag", "tie", "suitcase", "frisbee",
      "skis", "snowboard", "sports ball", "kite", "baseball bat", "baseball glove",
      "skateboard", "surfboard", "tennis racket", "bottle", "wine glass", "cup",
      "fork", "knife", "spoon", "bowl", "banana", "apple", "sandwich", "orange",
      "broccoli", "carrot", "hot dog", "pizza", "donut", "cake", "chair", "couch",
      "potted plant", "bed", "dining table", "toilet", "tv", "laptop", "mouse",
      "remote", "keyboard", "cell phone", "microwave", "oven", "toaster", "sink",
      "refrigerator", "book", "clock", "vase", "scissors", "teddy bear", "hair drier",
      "toothbrush"
    ]
    
    # GPUä¼˜åŒ–é…ç½®
    batch_size: 64           # åŸºç¡€batchå¤§å°
    batch_size_8gb: 32       # 8GBæ˜¾å­˜
    batch_size_16gb: 64      # 16GBæ˜¾å­˜
    batch_size_24gb: 128     # 24GBæ˜¾å­˜
    
    num_workers: 8           # GPUå¹¶è¡ŒåŠ è½½
    pin_memory: true         # GPUåŠ é€Ÿ
    persistent_workers: true
    
    # é«˜åˆ†è¾¨ç‡é…ç½®
    image_size: [640, 640]
    multi_scale: true
    multi_scale_range: [320, 640]
    
    # ä¸°å¯Œçš„æ•°æ®å¢å¼º
    train_transforms:
      - type: "Mosaic"
        prob: 1.0
      - type: "RandomAffine"
        degrees: 0.0
        translate: 0.1
        scale: [0.5, 1.5]
        shear: 0.0
      - type: "HSV"
        hgain: 0.015
        sgain: 0.7
        vgain: 0.4
      - type: "RandomFlip"
        prob: 0.5
      - type: "Resize"
        size: [640, 640]
      - type: "ToTensor"
      - type: "Normalize"
        mean: [0.485, 0.456, 0.406]
        std: [0.229, 0.224, 0.225]
    
    val_transforms:
      - type: "Resize"
        size: [640, 640]
      - type: "ToTensor"
      - type: "Normalize"
        mean: [0.485, 0.456, 0.406]
        std: [0.229, 0.224, 0.225]
    
    # ä¸‹è½½é…ç½®
    downloads:
      train_images:
        url: "http://images.cocodataset.org/zips/train2017.zip"
        size: "18GB"
        checksum: "69a8bb58ea5f8f99d24875f21416de2e"
      val_images:
        url: "http://images.cocodataset.org/zips/val2017.zip"
        size: "1GB"
        checksum: "4950dc9d00dbe1c305eeaa38c1a2f7ab"
      annotations:
        url: "http://images.cocodataset.org/annotations/annotations_trainval2017.zip"
        size: "252MB"
        checksum: "113a836d90195c0a5b2dbe11b1e66d1b"

  imagenet:
    name: "ImageNet-production"
    dataset_type: "ImageNetClassification"
    description: "ImageNet-1Kå®Œæ•´æ•°æ®é›†ï¼Œ128ä¸‡è®­ç»ƒå›¾åƒï¼Œ1000ä¸ªç±»åˆ«"
    
    data_dir: "./data/production/imagenet"
    train_dir: "train"
    val_dir: "val"
    
    # å¤§è§„æ¨¡æ•°æ®é…ç½®
    num_samples: 1281167
    train_samples: 1281167
    val_samples: 50000
    num_classes: 1000
    
    # GPUä¼˜åŒ–batché…ç½®
    batch_size: 256          # åŸºç¡€é…ç½®
    batch_size_8gb: 128      # 8GBæ˜¾å­˜
    batch_size_16gb: 256     # 16GBæ˜¾å­˜
    batch_size_24gb: 512     # 24GBæ˜¾å­˜
    
    num_workers: 16
    pin_memory: true
    persistent_workers: true
    
    # æ ‡å‡†ImageNetå°ºå¯¸
    image_size: [224, 224]
    
    # å®Œæ•´æ•°æ®å¢å¼º
    train_transforms:
      - type: "RandomResizedCrop"
        size: [224, 224]
        scale: [0.08, 1.0]
        ratio: [0.75, 1.33]
      - type: "RandomHorizontalFlip"
        prob: 0.5
      - type: "ColorJitter"
        brightness: 0.4
        contrast: 0.4
        saturation: 0.4
        hue: 0.1
      - type: "ToTensor"
      - type: "Normalize"
        mean: [0.485, 0.456, 0.406]
        std: [0.229, 0.224, 0.225]
    
    val_transforms:
      - type: "Resize"
        size: [256, 256]
      - type: "CenterCrop"
        size: [224, 224]
      - type: "ToTensor"
      - type: "Normalize"
        mean: [0.485, 0.456, 0.406]
        std: [0.229, 0.224, 0.225]
    
    # éœ€è¦ç”¨æˆ·è‡ªè¡Œä¸‹è½½ImageNet
    download_instructions: |
      ImageNetæ•°æ®é›†éœ€è¦ç”¨æˆ·è‡ªè¡Œä»å®˜ç½‘ä¸‹è½½ï¼š
      1. æ³¨å†ŒImageNetè´¦æˆ·ï¼šhttp://www.image-net.org/
      2. ä¸‹è½½ILSVRC2012è®­ç»ƒé›†å’ŒéªŒè¯é›†
      3. è§£å‹åˆ°./data/production/imagenet/
      4. è¿è¡Œæ•°æ®éªŒè¯è„šæœ¬

  openimages:
    name: "OpenImages-production"
    dataset_type: "OpenImagesDetection"
    description: "Google Open Images V6ï¼Œ170ä¸‡è®­ç»ƒå›¾åƒï¼Œ600ä¸ªç±»åˆ«"
    
    data_dir: "./data/production/openimages"
    
    # è¶…å¤§è§„æ¨¡æ•°æ®
    num_samples: 1743042
    train_samples: 1743042
    val_samples: 41620
    num_classes: 600
    
    # è¶…å¤§è§„æ¨¡batché…ç½®
    batch_size: 64           # åŸºç¡€é…ç½®
    batch_size_8gb: 16       # 8GBæ˜¾å­˜ï¼ˆä¿å®ˆï¼‰
    batch_size_16gb: 32      # 16GBæ˜¾å­˜
    batch_size_24gb: 64      # 24GBæ˜¾å­˜
    batch_size_48gb: 128     # 48GBæ˜¾å­˜ï¼ˆA100ï¼‰
    
    num_workers: 16
    pin_memory: true
    
    # é«˜åˆ†è¾¨ç‡
    image_size: [512, 512]
    
    # ä¸‹è½½é…ç½®
    downloads:
      train_images:
        url: "https://storage.googleapis.com/openimages/2018_04/train/train-images-boxable.csv"
        note: "éœ€è¦åˆ†æ‰¹æ¬¡ä¸‹è½½ï¼Œæ€»å¤§å°çº¦500GB"
      validation_images:
        url: "https://storage.googleapis.com/openimages/2018_04/validation/validation-images-boxable.csv"
      annotations:
        url: "https://storage.googleapis.com/openimages/2018_04/annotations/oidv6-train-annotations-bbox.csv"

# ç”Ÿäº§ç¯å¢ƒéªŒè¯æ ‡å‡†
production_validation:
  # æ€§èƒ½åŸºå‡†
  performance_benchmarks:
    coco2017:
      training_time_1epoch:
        "8GB_GPU": "~120åˆ†é’Ÿ"
        "16GB_GPU": "~60åˆ†é’Ÿ"
        "24GB_GPU": "~30åˆ†é’Ÿ"
      memory_usage:
        "batch_32": "~6GB"
        "batch_64": "~12GB"
        "batch_128": "~24GB"
    
    imagenet:
      training_time_1epoch:
        "8GB_GPU": "~180åˆ†é’Ÿ"
        "16GB_GPU": "~90åˆ†é’Ÿ"
        "24GB_GPU": "~45åˆ†é’Ÿ"
      memory_usage:
        "batch_128": "~4GB"
        "batch_256": "~8GB"
        "batch_512": "~16GB"
  
  # å®Œæ•´æ€§éªŒè¯
  integrity_checks:
    - "ç›®å½•ç»“æ„å®Œæ•´æ€§"
    - "æ–‡ä»¶æ•°é‡éªŒè¯"
    - "å›¾åƒæ–‡ä»¶å¯è¯»æ€§"
    - "æ ‡æ³¨æ–‡ä»¶æ ¼å¼éªŒè¯"
    - "ç±»åˆ«ä¸€è‡´æ€§æ£€æŸ¥"
    - "å†…å­˜ä½¿ç”¨ç›‘æ§"
    - "æ•°æ®åŠ è½½æ€§èƒ½æµ‹è¯•"
  
  # å­˜å‚¨éœ€æ±‚
  storage_requirements:
    coco2017: "~20GBï¼ˆå«è§£å‹æ–‡ä»¶ï¼‰"
    imagenet: "~150GBï¼ˆå«è§£å‹æ–‡ä»¶ï¼‰"
    openimages: "~500GBï¼ˆå«è§£å‹æ–‡ä»¶ï¼‰"
  
  # ç½‘ç»œè¦æ±‚
  network_requirements:
    min_bandwidth: "100Mbps"
    estimated_download_time:
      coco2017: "~30åˆ†é’Ÿ"
      imagenet: "~4å°æ—¶"
      openimages: "~12å°æ—¶"